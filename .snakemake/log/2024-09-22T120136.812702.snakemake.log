Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Conda environments: ignored
Job stats:
job      count
-----  -------
16           1
17           1
all          1
total        3

Select jobs to execute...
Execute 1 jobs...

[Sun Sep 22 12:01:36 2024]
localrule 17:
    input: data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta, data/genome-simulations/genomes_2/demultiplexed/sample_1/genome_2_Ind1_R1_demultiplexed.fastq, data/genome-simulations/genomes_2/demultiplexed/sample_1/genome_2_Ind1_R2_demultiplexed.fastq, data/genome-simulations/genomes_2/demultiplexed/sample_2/genome_2_Ind2_R1_demultiplexed.fastq, data/genome-simulations/genomes_2/demultiplexed/sample_2/genome_2_Ind2_R2_demultiplexed.fastq
    output: data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.amb, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.ann, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.bwt, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.pac, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.sa, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.fai, data/genome-simulations/genomes_2/fasta/reference_genome_2.dict, data/genome-simulations/genomes_2/demultiplexed/sample_1/aligned_genome_2_Ind1.sam, data/genome-simulations/genomes_2/demultiplexed/sample_2/aligned_genome_2_Ind2.sam, data/genome-simulations/genomes_2/demultiplexed/sample_1/aligned_genome_2_Ind1.bam, data/genome-simulations/genomes_2/demultiplexed/sample_2/aligned_genome_2_Ind2.bam, data/genome-simulations/genomes_2/demultiplexed/sample_1/sorted_aligned_genome_2_Ind1.bam, data/genome-simulations/genomes_2/demultiplexed/sample_2/sorted_aligned_genome_2_Ind2.bam, data/genome-simulations/genomes_2/demultiplexed/sample_1/sorted_aligned_genome_2_Ind1.bam.bai, data/genome-simulations/genomes_2/demultiplexed/sample_2/sorted_aligned_genome_2_Ind2.bam.bai
    jobid: 16
    reason: Missing output files: data/genome-simulations/genomes_2/demultiplexed/sample_2/sorted_aligned_genome_2_Ind2.bam.bai, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.amb, data/genome-simulations/genomes_2/fasta/reference_genome_2.dict, data/genome-simulations/genomes_2/demultiplexed/sample_1/sorted_aligned_genome_2_Ind1.bam.bai, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.fai, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.bwt, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.ann, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.sa, data/genome-simulations/genomes_2/fasta/reference_genome_2.fasta.pac
    resources: tmpdir=/var/folders/vr/dm12jytd28d0_z61hq3l47n40000gp/T

RuleException in rule 17 in file /Users/emanuelmfonseca/project/sequencing-migration/Snakefile, line 263:
AttributeError: 'Wildcards' object has no attribute 'sample', when formatting the following:

            # Index the reference genome
            bwa index {input.reference}
            
            # Generate the FASTA index (.fai) file using samtools faidx
            samtools faidx {input.reference}
            
            # Generate the sequence dictionary (.dict) file using Picard
            picard CreateSequenceDictionary R={input.reference} O={output.dicti}
            
            # Loop over each sample to align demultiplexed FASTQ reads and process SAM/BAM files
            for sample in {wildcards.sample}; do
                # Align the demultiplexed FASTQ reads to the reference genome and output SAM file
                bwa mem -M -R "@RG\tID:{params.RGID}\tLB:{params.RGLB}\tPL:{params.RGPL}\tPM:{params.RGPM}\tSM:{params.RGSM}" {input.reference} {input.fastq_demultiplexed[0]} {input.fastq_demultiplexed[1]} > data/genome-simulations/genomes_{params.weekly_run}/demultiplexed/sample_${{sample}}/aligned_genome_{params.weekly_run}_Ind${{sample}}.sam;
                
                # Convert SAM to BAM
                samtools view -Sb data/genome-simulations/genomes_{params.weekly_run}/demultiplexed/sample_${{sample}}/aligned_genome_{params.weekly_run}_Ind${{sample}}.sam > data/genome-simulations/genomes_{params.weekly_run}/demultiplexed/sample_${{sample}}/aligned_genome_{params.weekly_run}_Ind${{sample}}.bam;
                
                # Sort the BAM file
                samtools sort data/genome-simulations/genomes_{params.weekly_run}/demultiplexed/sample_${{sample}}/aligned_genome_{params.weekly_run}_Ind${{sample}}.bam -o data/genome-simulations/genomes_{params.weekly_run}/demultiplexed/sample_${{sample}}/sorted_aligned_genome_{params.weekly_run}_Ind${{sample}}.bam;

                # Index the sorted BAM file
                samtools index data/genome-simulations/genomes_{params.weekly_run}/demultiplexed/sample_${{sample}}/sorted_aligned_genome_{params.weekly_run}_Ind${{sample}}.bam;
            done
            
